<div class="bg-white rounded-3xl shadow-md p-5 border border-indigo-50 relative overflow-hidden">
    <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-indigo-500 to-purple-500"></div>
    <h2 class="text-lg font-bold mb-4 flex items-center text-gray-800">
        <i class="fas fa-camera text-indigo-500 mr-2"></i> Nueva Entrega
    </h2>
    <form id="uploadForm" enctype="multipart/form-data" class="space-y-4">
        <div>
            <label class="block w-full cursor-pointer bg-gray-50 hover:bg-gray-100 border-2 border-dashed border-gray-300 hover:border-indigo-400 rounded-xl p-6 transition text-center group">
                <i class="fas fa-cloud-upload-alt text-3xl text-gray-400 group-hover:text-indigo-500 mb-2 transition"></i>
                <span class="block text-sm text-gray-500">Toca para subir foto</span>
                <input type="file" id="receipt" name="receipt" accept="image/*" capture="environment" required class="hidden">
            </label>
            <p id="fileName" class="text-xs text-center mt-2 text-gray-400 truncate"></p>
        </div>
        <div class="relative">
            <i class="fas fa-pen absolute left-4 top-3.5 text-gray-400 text-sm"></i>
            <input type="text" id="notes" name="notes" placeholder="Notas (opcional)..." 
                   class="w-full pl-10 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:outline-none transition text-sm">
        </div>
        <button type="submit" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3.5 rounded-xl shadow-lg shadow-indigo-500/30 transition transform active:scale-95 flex justify-center items-center gap-2">
            <span id="uploadText">Procesar Factura</span>
            <div id="spinner" class="hidden animate-spin h-5 w-5 border-2 border-white border-t-transparent rounded-full"></div>
        </button>
    </form>
</div>

<!-- cropper -->
<div id="cropModal" class="hidden fixed inset-0 z-50 overflow-auto bg-black bg-opacity-50">
    <div class="flex items-center justify-center min-h-screen p-4">
        <div class="bg-white rounded-3xl shadow-xl w-full max-w-4xl">
            <div class="flex justify-between items-center p-6 border-b">
                <h3 class="text-lg font-bold text-gray-800">Editar Foto</h3>
                <button id="closeCropModal" type="button" class="text-gray-400 hover:text-gray-600 transition">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div class="p-6">
                <div class="flex flex-col lg:flex-row gap-6">
                    <div class="lg:w-2/3">
                        <div id="imageContainer" class="bg-gray-100 rounded-xl overflow-hidden flex items-center justify-center" style="height: 400px; min-height: 300px;">
                            <img id="imageToCrop" class="max-w-full max-h-full" alt="Imagen a recortar">
                        </div>
                    </div>
                    
                    <div class="lg:w-1/3 space-y-6">
                        <div>
                            <h4 class="font-medium text-gray-700 mb-3">Controles</h4>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm text-gray-600 mb-1">Zoom</label>
                                    <input type="range" id="zoomSlider" min="0.1" max="3" step="0.1" value="1" class="w-full">
                                </div>
                                <div>
                                    <label class="block text-sm text-gray-600 mb-1">Rotar</label>
                                    <div class="flex gap-2">
                                        <button type="button" id="rotateLeft" class="flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 py-2 rounded-lg transition">
                                            <i class="fas fa-undo"></i> 90°
                                        </button>
                                        <button type="button" id="rotateRight" class="flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 py-2 rounded-lg transition">
                                            <i class="fas fa-redo"></i> 90°
                                        </button>
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-sm text-gray-600 mb-1">Relación de aspecto</label>
                                    <div class="grid grid-cols-2 gap-2">
                                        <button type="button" data-ratio="NaN" class="aspect-btn bg-indigo-100 text-indigo-700 py-2 rounded-lg text-sm transition">
                                            Libre
                                        </button>
                                        <button type="button" data-ratio="1" class="aspect-btn bg-gray-100 hover:bg-gray-200 text-gray-700 py-2 rounded-lg text-sm transition">
                                            1:1
                                        </button>
                                        <button type="button" data-ratio="4/3" class="aspect-btn bg-gray-100 hover:bg-gray-200 text-gray-700 py-2 rounded-lg text-sm transition">
                                            4:3
                                        </button>
                                        <button type="button" data-ratio="16/9" class="aspect-btn bg-gray-100 hover:bg-gray-200 text-gray-700 py-2 rounded-lg text-sm transition">
                                            16:9
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="pt-4 border-t">
                            <div class="flex gap-3">
                                <button type="button" id="cancelCrop" class="flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-3 rounded-xl transition">
                                    Cancelar
                                </button>
                                <button type="button" id="saveCrop" class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-3 rounded-xl shadow-lg shadow-indigo-500/30 transition">
                                    Guardar Cambios
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>